{"remainingRequest":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/DeviceManagement.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/DeviceManagement.vue","mtime":1607284537696},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBQYWlyRGV2aWNlRm9ybSBmcm9tICdAL2NvbXBvbmVudHMvZGV2aWNlL1BhaXJEZXZpY2VGb3JtJwppbXBvcnQgRGV2aWNlTGlzdCBmcm9tICdAL2NvbXBvbmVudHMvZGV2aWNlL0RldmljZUxpc3QnCgpleHBvcnQgZGVmYXVsdCB7CiAgICBjb21wb25lbnRzOiB7IAogICAgICAgIFBhaXJEZXZpY2VGb3JtLAogICAgICAgIERldmljZUxpc3QKICAgIH0sCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGFkZEJhbmRNb2RlOiBmYWxzZSwKICAgICAgICAgICAgbGlzdGtleTogZmFsc2UsCiAgICAgICAgICAgIG1pYmFuZF9kYl9ob3N0OiB0aGlzLiRhcGlfaG9zdHNbJ21pYmFuZF9kYl9hcGknXSwKICAgICAgICAgICAgbWliYW5kX2RiX3BvcnQ6IHRoaXMuJGFwaV9wb3J0c1snbWliYW5kX2RiX2FwaSddLAogICAgICAgICAgICBtaWJhbmRfaG9zdDogdGhpcy4kYXBpX2hvc3RzWydtaWJhbmRfYXBpJ10sCiAgICAgICAgICAgIG1pYmFuZF9wb3J0OiB0aGlzLiRhcGlfcG9ydHNbJ21pYmFuZF9hcGknXQogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgZW50ZXJBZGRCYW5kTW9kZSgpIHsKICAgICAgICAgICAgdGhpcy5hZGRCYW5kTW9kZSA9IHRydWUKICAgICAgICB9LAogICAgICAgIGV4aXRBZGRCYW5kTW9kZSgpIHsKICAgICAgICAgICAgdGhpcy5hZGRCYW5kTW9kZSA9IGZhbHNlCiAgICAgICAgfSwKCiAgICAgICAgdXBkYXRlTGlzdERpc3BsYXkoKSB7CiAgICAgICAgICAgIHRoaXMubGlzdGtleSA9ICF0aGlzLmxpc3RrZXkKICAgICAgICB9LAoKICAgICAgICBhc3luYyByZW1vdmVCYW5kRGJBcGlDYWxsKGJhbmQpIHsKICAgICAgICAgICAgY29uc3QgYmFuZGlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoJ21pYmFuZCcpLmlkCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwOi8vJHt0aGlzLm1pYmFuZF9kYl9ob3N0fToke3RoaXMubWliYW5kX2RiX3BvcnR9L2JhbmRzLyR7aWR9YCwgewogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogIkRFTEVURSIKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCkKCiAgICAgICAgICAgICAgICAvLyBkbyBzb21ldGhpbmcgd2l0aCBgZGF0YWAKICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnZGVsZXRlLXJlc3VsdCddPT0ic3VjY2VlZGVkIikKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gZmFsc2UKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIC8vIGRvIHNvbWV0aGluZyB3aXRoIGBlcnJvcmAKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGRpc2Nvbm5lY3RBcGlDYWxsKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cDovLyR7dGhpcy5taWJhbmRfaG9zdH06JHt0aGlzLm1pYmFuZF9wb3J0fS9iYW5kL2Rpc2Nvbm5lY3RgKQogICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpCiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAvLyBkbyBzb21ldGhpbmcgd2l0aCBgZXJyb3JgCiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICByZW1vdmVCYW5kKGJhbmQpIHsKICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0QXBpQ2FsbCgpCiAgICAgICAgICAgIHRoaXMucmVtb3ZlQmFuZERiQXBpQ2FsbChiYW5kKS50aGVuKCgpPT57CiAgICAgICAgICAgICAgICB0aGlzLiRzZXNzaW9uLnJlbW92ZSgnbWliYW5kJykKICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTGlzdERpc3BsYXkoKQogICAgICAgICAgICB9KQogICAgICAgIH0KICAgIH0KfQo="},{"version":3,"sources":["DeviceManagement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DeviceManagement.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <b-card title=\"My device\">\n        <b-button variant=\"outline-primary\" class=\"w-100\" @click=\"enterAddBandMode\">+ Add device</b-button>\n        <pair-device-form v-if=\"addBandMode\" \n            @exit-add-band-mode=\"exitAddBandMode\"\n            @update-list-display=\"updateListDisplay\"\n        />\n        <device-list class=\"mt-1\" :key=\"listkey\"\n            @unpair-band=\"removeBand\"\n            @update-list-display=\"updateListDisplay\"\n        />\n    </b-card>\n</template>\n\n<script>\nimport PairDeviceForm from '@/components/device/PairDeviceForm'\nimport DeviceList from '@/components/device/DeviceList'\n\nexport default {\n    components: { \n        PairDeviceForm,\n        DeviceList\n    },\n    data() {\n        return {\n            addBandMode: false,\n            listkey: false,\n            miband_db_host: this.$api_hosts['miband_db_api'],\n            miband_db_port: this.$api_ports['miband_db_api'],\n            miband_host: this.$api_hosts['miband_api'],\n            miband_port: this.$api_ports['miband_api']\n        }\n    },\n    methods: {\n        enterAddBandMode() {\n            this.addBandMode = true\n        },\n        exitAddBandMode() {\n            this.addBandMode = false\n        },\n\n        updateListDisplay() {\n            this.listkey = !this.listkey\n        },\n\n        async removeBandDbApiCall(band) {\n            const bandid = this.$session.get('miband').id\n            try {\n                const response = await fetch(`http://${this.miband_db_host}:${this.miband_db_port}/bands/${id}`, {\n                    method: \"DELETE\"\n                })\n                const result = await response.json()\n\n                // do something with `data`\n                if(result['delete-result']==\"succeeded\")\n                    return true\n                else return false\n            } catch (error) {\n                // do something with `error`\n            }\n        },\n\n        async disconnectApiCall() {\n            try {\n                const response = await fetch(`http://${this.miband_host}:${this.miband_port}/band/disconnect`)\n                const result = await response.json()\n                console.log(result)\n                return result\n            } catch (error) {\n                // do something with `error`\n            }\n        },\n\n        removeBand(band) {\n            this.disconnectApiCall()\n            this.removeBandDbApiCall(band).then(()=>{\n                this.$session.remove('miband')\n                this.updateListDisplay()\n            })\n        }\n    }\n}\n</script>"]}]}