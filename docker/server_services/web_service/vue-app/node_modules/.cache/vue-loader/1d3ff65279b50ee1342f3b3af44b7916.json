{"remainingRequest":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/DeviceManagement.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/DeviceManagement.vue","mtime":1607529212872},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBQYWlyRGV2aWNlRm9ybSBmcm9tICdAL2NvbXBvbmVudHMvZGV2aWNlL1BhaXJEZXZpY2VGb3JtJwppbXBvcnQgRGV2aWNlTGlzdCBmcm9tICdAL2NvbXBvbmVudHMvZGV2aWNlL0RldmljZUxpc3QnCgpleHBvcnQgZGVmYXVsdCB7CiAgICBjb21wb25lbnRzOiB7IAogICAgICAgIFBhaXJEZXZpY2VGb3JtLAogICAgICAgIERldmljZUxpc3QKICAgIH0sCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGFkZEJhbmRNb2RlOiBmYWxzZSwKICAgICAgICAgICAgbGlzdGtleTogZmFsc2UsCiAgICAgICAgICAgIG1pYmFuZF9kYl9ob3N0OiB0aGlzLiRhcGlfaG9zdHNbJ21pYmFuZF9kYl9hcGknXSwKICAgICAgICAgICAgbWliYW5kX2RiX3BvcnQ6IHRoaXMuJGFwaV9wb3J0c1snbWliYW5kX2RiX2FwaSddLAogICAgICAgICAgICBtaWJhbmRfaG9zdDogdGhpcy4kYXBpX2hvc3RzWydtaWJhbmRfYXBpJ10sCiAgICAgICAgICAgIG1pYmFuZF9wb3J0OiB0aGlzLiRhcGlfcG9ydHNbJ21pYmFuZF9hcGknXQogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgZW50ZXJBZGRCYW5kTW9kZSgpIHsKICAgICAgICAgICAgdGhpcy5hZGRCYW5kTW9kZSA9IHRydWUKICAgICAgICB9LAogICAgICAgIGV4aXRBZGRCYW5kTW9kZSgpIHsKICAgICAgICAgICAgdGhpcy5hZGRCYW5kTW9kZSA9IGZhbHNlCiAgICAgICAgfSwKCiAgICAgICAgdXBkYXRlTGlzdERpc3BsYXkoKSB7CiAgICAgICAgICAgIHRoaXMubGlzdGtleSA9ICF0aGlzLmxpc3RrZXkKICAgICAgICB9LAoKICAgICAgICBhc3luYyB1bnBhaXJCYW5kRGJBcGlDYWxsKCkgewogICAgICAgICAgICBjb25zdCBiYW5kaWQgPSB0aGlzLiRzZXNzaW9uLmdldCgnbWliYW5kJykuaWQKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHA6Ly8ke3RoaXMubWliYW5kX2RiX2hvc3R9OiR7dGhpcy5taWJhbmRfZGJfcG9ydH0vYmFuZHMvJHtiYW5kaWR9L3VucGFpcmApCiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCkKCiAgICAgICAgICAgICAgICAvLyBkbyBzb21ldGhpbmcgd2l0aCBgZGF0YWAKICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsndW5wYWlyLWJhbmQtcmVzdWx0J109PSJzdWNjZWVkZWQiKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgICAgICBlbHNlIHJldHVybiBmYWxzZQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgLy8gZG8gc29tZXRoaW5nIHdpdGggYGVycm9yYAogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgZGlzY29ubmVjdEFwaUNhbGwoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwOi8vJHt0aGlzLm1pYmFuZF9ob3N0fToke3RoaXMubWliYW5kX3BvcnR9L2JhbmQvZGlzY29ubmVjdGApCiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCkKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIC8vIGRvIHNvbWV0aGluZyB3aXRoIGBlcnJvcmAKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIHJlbW92ZUJhbmQoKSB7CiAgICAgICAgICAgIC8vIG5lZWQgZGVsZXRlIGFsbCBsb2dzCiAgICAgICAgICAgIHRoaXMuZGlzY29ubmVjdEFwaUNhbGwoKQogICAgICAgICAgICB0aGlzLnVucGFpckJhbmREYkFwaUNhbGwoKS50aGVuKCgpPT57CiAgICAgICAgICAgICAgICB0aGlzLiRzZXNzaW9uLnJlbW92ZSgnbWliYW5kJykKICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTGlzdERpc3BsYXkoKQogICAgICAgICAgICB9KQogICAgICAgIH0KICAgIH0KfQo="},{"version":3,"sources":["DeviceManagement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAkBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DeviceManagement.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <b-card title=\"My device\">\n        <b-button v-if=\"$session.get('miband')==undefined\" \n            variant=\"outline-primary\" class=\"w-100\" \n            @click=\"enterAddBandMode\"\n        >+ Add Miband</b-button>\n        <pair-device-form v-if=\"addBandMode\" \n            @exit-add-band-mode=\"exitAddBandMode\"\n            @update-list-display=\"updateListDisplay\"\n        />\n        <device-list class=\"mt-1\" :key=\"listkey\"\n            @unpair-band=\"removeBand\"\n            @update-list-display=\"updateListDisplay\"\n        />\n    </b-card>\n</template>\n\n<script>\nimport PairDeviceForm from '@/components/device/PairDeviceForm'\nimport DeviceList from '@/components/device/DeviceList'\n\nexport default {\n    components: { \n        PairDeviceForm,\n        DeviceList\n    },\n    data() {\n        return {\n            addBandMode: false,\n            listkey: false,\n            miband_db_host: this.$api_hosts['miband_db_api'],\n            miband_db_port: this.$api_ports['miband_db_api'],\n            miband_host: this.$api_hosts['miband_api'],\n            miband_port: this.$api_ports['miband_api']\n        }\n    },\n    methods: {\n        enterAddBandMode() {\n            this.addBandMode = true\n        },\n        exitAddBandMode() {\n            this.addBandMode = false\n        },\n\n        updateListDisplay() {\n            this.listkey = !this.listkey\n        },\n\n        async unpairBandDbApiCall() {\n            const bandid = this.$session.get('miband').id\n            try {\n                const response = await fetch(`http://${this.miband_db_host}:${this.miband_db_port}/bands/${bandid}/unpair`)\n                const result = await response.json()\n\n                // do something with `data`\n                if(result['unpair-band-result']==\"succeeded\")\n                    return true\n                else return false\n            } catch (error) {\n                // do something with `error`\n            }\n        },\n\n        async disconnectApiCall() {\n            try {\n                const response = await fetch(`http://${this.miband_host}:${this.miband_port}/band/disconnect`)\n                const result = await response.json()\n                return result\n            } catch (error) {\n                // do something with `error`\n            }\n        },\n\n        removeBand() {\n            // need delete all logs\n            this.disconnectApiCall()\n            this.unpairBandDbApiCall().then(()=>{\n                this.$session.remove('miband')\n                this.updateListDisplay()\n            })\n        }\n    }\n}\n</script>"]}]}