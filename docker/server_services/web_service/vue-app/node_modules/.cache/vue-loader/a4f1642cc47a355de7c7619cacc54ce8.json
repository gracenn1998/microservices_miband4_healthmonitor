{"remainingRequest":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/account/Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/account/Profile.vue","mtime":1607539087626},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBEZXZpY2VNYW5hZ2VtZW50IGZyb20gJ0AvY29tcG9uZW50cy9EZXZpY2VNYW5hZ2VtZW50JwppbXBvcnQgQ2hhbmdlUGFzc3dvcmRGb3JtIGZyb20gJ0AvY29tcG9uZW50cy9hY2NvdW50L0NoYW5nZVBhc3N3b3JkRm9ybS52dWUnCgpleHBvcnQgZGVmYXVsdCB7CiAgICBjb21wb25lbnRzOiB7IAogICAgICAgIERldmljZU1hbmFnZW1lbnQsCiAgICAgICAgQ2hhbmdlUGFzc3dvcmRGb3JtCiAgICB9LAogICAgY3JlYXRlZCgpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnVzZXIpCiAgICAgICAgdGhpcy5nZW5lcmF0ZUF2dFN0cigpCiAgICAgICAgCiAgICB9LAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICB1c2VyOiB0aGlzLiRzZXNzaW9uLmdldCgndXNlcicpLAogICAgICAgICAgICBhdmF0YXJTdHI6ICcnLAogICAgICAgICAgICB1cGRhdGVOYW1lTW9kZTogZmFsc2UsCiAgICAgICAgICAgIGNoYW5nZVB3TW9kZTogZmFsc2UsCiAgICAgICAgICAgIGRlbGV0ZVN0YXR1czogJycsCiAgICAgICAgICAgIHVzZXJfZGJfaG9zdDogdGhpcy4kYXBpX2hvc3RzWyd1c2VyX2RiX2FwaSddLAogICAgICAgICAgICB1c2VyX2RiX3BvcnQ6IHRoaXMuJGFwaV9wb3J0c1sndXNlcl9kYl9hcGknXSwKICAgICAgICAgICAgbWliYW5kX2RiX2hvc3Q6IHRoaXMuJGFwaV9ob3N0c1snbWliYW5kX2RiX2FwaSddLAogICAgICAgICAgICBtaWJhbmRfZGJfcG9ydDogdGhpcy4kYXBpX3BvcnRzWydtaWJhbmRfZGJfYXBpJ10sCiAgICAgICAgICAgIG1pYmFuZF9ob3N0OiB0aGlzLiRhcGlfaG9zdHNbJ21pYmFuZF9hcGknXSwKICAgICAgICAgICAgbWliYW5kX3BvcnQ6IHRoaXMuJGFwaV9wb3J0c1snbWliYW5kX2FwaSddCiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBlbnRlclVwZGF0ZU5hbWVNb2RlKCkgewogICAgICAgICAgICB0aGlzLnVwZGF0ZU5hbWVNb2RlID0gdHJ1ZQogICAgICAgIH0sCiAgICAgICAgZXhpdFVwZGF0ZU5hbWVNb2RlKCkgewogICAgICAgICAgICB0aGlzLnVzZXIuZnVsbG5hbWU9dGhpcy4kc2Vzc2lvbi5nZXQoJ3VzZXInKS5mdWxsbmFtZQogICAgICAgICAgICB0aGlzLnVwZGF0ZU5hbWVNb2RlID0gZmFsc2UKICAgICAgICB9LAogICAgICAgIGVudGVyQ2hhbmdlUHdNb2RlKCkgewogICAgICAgICAgICB0aGlzLmNoYW5nZVB3TW9kZSA9IHRydWUKICAgICAgICB9LAogICAgICAgIGV4aXRDaGFuZ2VQd01vZGUoKSB7CiAgICAgICAgICAgIHRoaXMuY2hhbmdlUHdNb2RlID0gZmFsc2UKICAgICAgICB9LAoKICAgICAgICBnZW5lcmF0ZUF2dFN0cigpIHsKICAgICAgICAgICAgaWYodGhpcy51c2VyLmZ1bGxuYW1lIT1udWxsKSB7CiAgICAgICAgICAgICAgICB2YXIgc3RyID0gU3RyaW5nKHRoaXMuJHNlc3Npb24uZ2V0KCd1c2VyJykuZnVsbG5hbWUpCiAgICAgICAgICAgICAgICB2YXIgc2VwZXJhdGVOYW1lID0gc3RyLnNwbGl0KCIgIikKICAgICAgICAgICAgICAgIGlmKHNlcGVyYXRlTmFtZS5sZW5ndGg9PTEpewogICAgICAgICAgICAgICAgICAgIHRoaXMuYXZhdGFyU3RyID0gc2VwZXJhdGVOYW1lWzBdWzBdCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYXZhdGFyU3RyPXNlcGVyYXRlTmFtZVswXVswXSArIHNlcGVyYXRlTmFtZVtzZXBlcmF0ZU5hbWUubGVuZ3RoLTFdWzBdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgdGhpcy5hdmF0YXJTdHI9JycKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGFzeW5jIHVwZGF0ZU5hbWVBcGlDYWxsKG5ld05hbWUpIHsKICAgICAgICAgICAgY29uc3QgdWlkID0gdGhpcy4kc2Vzc2lvbi5nZXQoJ3VzZXInKS5pZAogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cDovLyR7dGhpcy51c2VyX2RiX2hvc3R9OiR7dGhpcy51c2VyX2RiX3BvcnR9L3VzZXJzLyR7dWlkfS9mdWxsbmFtZWAsIHsKICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsCiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgJ2Z1bGxuYW1lJzogbmV3TmFtZSwKICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04JyB9LAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCByZXNwb25zZS5qc29uKCkKICAgICAgICAgICAgICAgIHJldHVybiB1c2VyCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB1cGRhdGVOYW1lKCkgewogICAgICAgICAgICAvLyB0aGlzLnVwZGF0ZU5hbWVBcGlDYWxsKHRoaXMudXNlci5lbWFpbCwgdGhpcy51c2VyLmZ1bGxuYW1lKQogICAgICAgICAgICB0aGlzLnVwZGF0ZU5hbWVBcGlDYWxsKHRoaXMudXNlci5mdWxsbmFtZSkudGhlbigodXNlcik9PnsKICAgICAgICAgICAgICAgIHRoaXMuJHNlc3Npb24uc2V0KCd1c2VyJywgdXNlcikKICAgICAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVBdnRTdHIoKQogICAgICAgICAgICAgICAgdGhpcy5leGl0VXBkYXRlTmFtZU1vZGUoKQogICAgICAgICAgICAgICAgLy8gdGhpcy4kZm9yY2VVcGRhdGUKICAgICAgICAgICAgfSkKICAgICAgICB9LAoKICAgICAgICBhc3luYyBkZWxldGVMb2dzQXBpQ2FsbCgpIHsKICAgICAgICAgICAgY29uc3QgdXNlcl9pZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCd1c2VyJykuaWQKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHA6Ly8ke3RoaXMubWliYW5kX2RiX2hvc3R9OiR7dGhpcy5taWJhbmRfZGJfcG9ydH0vdXNlcnMvJHt1c2VyX2lkfS9sb2dzYCwgewogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCkKICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnZGVsZXRlLXJlc3VsdCddPT0nc3VjY2VlZGVkJykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgZGVsZXRlVXNlckFwaUNhbGwoKSB7CiAgICAgICAgICAgIGNvbnN0IHVzZXJfaWQgPSB0aGlzLiRzZXNzaW9uLmdldCgndXNlcicpLmlkCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwOi8vJHt0aGlzLnVzZXJfZGJfaG9zdH06JHt0aGlzLnVzZXJfZGJfcG9ydH0vdXNlcnMvJHt1c2VyX2lkfWAsIHsKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpCiAgICAgICAgICAgICAgICBpZihyZXN1bHRbJ2RlbGV0ZS1yZXN1bHQnXT09J3N1Y2NlZWRlZCcpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGFzeW5jIHVucGFpckJhbmREYkFwaUNhbGwoKSB7CiAgICAgICAgICAgIGNvbnN0IGJhbmRpZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCdtaWJhbmQnKS5pZAogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cDovLyR7dGhpcy5taWJhbmRfZGJfaG9zdH06JHt0aGlzLm1pYmFuZF9kYl9wb3J0fS9iYW5kcy8ke2JhbmRpZH0vdW5wYWlyYCkKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKQoKICAgICAgICAgICAgICAgIC8vIGRvIHNvbWV0aGluZyB3aXRoIGBkYXRhYAogICAgICAgICAgICAgICAgaWYocmVzdWx0Wyd1bnBhaXItYmFuZC1yZXN1bHQnXT09InN1Y2NlZWRlZCIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWUKICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuIGZhbHNlCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAvLyBkbyBzb21ldGhpbmcgd2l0aCBgZXJyb3JgCiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBhc3luYyBkaXNjb25uZWN0QXBpQ2FsbCgpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHA6Ly8ke3RoaXMubWliYW5kX2hvc3R9OiR7dGhpcy5taWJhbmRfcG9ydH0vYmFuZC9kaXNjb25uZWN0YCkKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKQogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KQogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgLy8gZG8gc29tZXRoaW5nIHdpdGggYGVycm9yYAogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgZGVsZXRlQW5kQ2xvc2VNb2RhbCgpIHsKICAgICAgICAgICAgdGhpcy4kYnZNb2RhbC5oaWRlKCdjb25maXJtLXJlbW92ZS1tb2RhbCcpCgogICAgICAgICAgICB0aGlzLmRlbGV0ZVN0YXR1cyA9ICdQRU5ESU5HJwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3QgZGVsZXRlTG9nc1Jlc3VsdCA9IGF3YWl0IHRoaXMuZGVsZXRlTG9nc0FwaUNhbGwoKQogICAgICAgICAgICB2YXIgdW5wYWlyQmFuZFJlc3VsdCA9IHRydWUKICAgICAgICAgICAgdmFyIGRlbGV0ZVVzZXJSZXN1bHQKICAgICAgICAgICAgaWYoZGVsZXRlTG9nc1Jlc3VsdCkgeyAvL2lmIHN1Y2NlZWRlZAogICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy4kc2Vzc2lvbi5nZXQoJ21pYmFuZCcpKQogICAgICAgICAgICAgICAgaWYodGhpcy4kc2Vzc2lvbi5nZXQoJ21pYmFuZCcpIT11bmRlZmluZWQpIHsgLy9pZiBwYWlyaW5nIGJhbmQgZXhpc3QKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnPz8nKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZGlzY29ubmVjdEFwaUNhbGwoKQogICAgICAgICAgICAgICAgICAgIHVucGFpckJhbmRSZXN1bHQgPSBhd2FpdCB0aGlzLnVucGFpckJhbmREYkFwaUNhbGwoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKHVucGFpckJhbmRSZXN1bHQpIHsKICAgICAgICAgICAgICAgIGRlbGV0ZVVzZXJSZXN1bHQgPSBhd2FpdCB0aGlzLmRlbGV0ZVVzZXJBcGlDYWxsKCkKICAgICAgICAgICAgICAgIGlmKGRlbGV0ZVVzZXJSZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZVN0YXR1cyA9ICdPSycKICAgICAgICAgICAgICAgICAgICB0aGlzLiRzZXNzaW9uLmRlc3Ryb3koKQogICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2xvZ2luLXN0YXR1cy1jaGFuZ2UnKQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvJykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICB9Cn0K"},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/components/account","sourcesContent":["<template>\n    <div class=\"w-50 mx-auto mt-3 mb-3\" v-if=\"this.$session.exists()\">\n        <b-card>\n            <template #header>\n                <div class=\"d-flex justify-content-center\">\n                    <b-avatar :text=\"avatarStr\" size=\"6rem\"></b-avatar>\n                </div>\n                <b-card-title v-if=\"user.fullname==null&&updateNameMode!=true\" class=\"text-center mt-2\">\n                    <b-button variant=\"outline-primary\" @click=\"enterUpdateNameMode\">\n                        Please tell us your name 📝\n                    </b-button>\n                </b-card-title>\n                <b-card-title v-else-if=\"updateNameMode==true\" class=\"text-center mt-2\">\n                    <b-form @submit.prevent=\"updateName\" inline class=\"d-flex justify-content-around\">\n                        <b-form-input class=\"w-75\"\n                        v-model=\"user.fullname\"\n                        placeholder=\"Enter your name\"\n                    ></b-form-input>\n                    <div>\n                        <b-button @click=\"updateName\" variant=\"success\" class=\"mr-1\">OK</b-button>\n                        <b-button @click=\"exitUpdateNameMode\" variant=\"danger\">✖️</b-button>\n                    </div>\n                    </b-form>\n                </b-card-title>\n                <b-card-title v-else class=\"text-center mt-2\">\n                    {{user.fullname}}\n                    <b-button variant=\"outline-primary\" @click=\"enterUpdateNameMode\">📝</b-button>\n                </b-card-title>\n                <b-card-sub-title class=\"text-center\">{{user.email}}</b-card-sub-title>\n                <!-- <div class=\"d-flex justify-content-center\">\n                    <b-card-text>🏆 Strike: 4days</b-card-text>\n                </div> -->\n            </template>\n\n            <b-skeleton-wrapper :loading=\"deleteStatus === 'PENDING'\">\n                <template #loading>\n                <b-card>\n                <b-skeleton width=\"85%\"></b-skeleton>\n                <b-skeleton width=\"55%\"></b-skeleton>\n                <b-skeleton width=\"70%\"></b-skeleton>\n                </b-card>\n            </template>\n            <device-management />\n\n            <!-- <b-card title=\"More\" class=\"mt-1\">\n                <b-button variant=\"outline-primary\" class=\"w-100\">Set goal</b-button>\n            </b-card> -->\n\n            <b-card title=\"Account\" class=\"mt-1\">\n                <b-button variant=\"outline-primary\" class=\"w-100 mb-1\"\n                    @click=\"enterChangePwMode\"\n                >Change password</b-button>\n                <ChangePasswordForm v-if=\"changePwMode==true\" @exit-change-pw-mode=\"exitChangePwMode\"/>\n                <b-button variant=\"outline-primary\" class=\"w-100\" v-b-modal.confirm-delete-modal >Delete account</b-button>\n                \n            </b-card>\n            \n            <b-modal id=\"confirm-delete-modal\" hide-footer title=\"Confirmation\">\n                <div class=\"d-block text-center\">\n                    <h4>Do you really want to delete this account?</h4>\n                </div>\n                <div class=\"d-flex justify-content-end\">\n                    <b-button class=\"mt-3 mr-3\"  @click=\"$bvModal.hide('confirm-delete-modal')\">Cancel</b-button>\n                    <b-button class=\"mt-3 mr-4\" variant=\"danger\" @click=\"deleteAndCloseModal()\">Delete</b-button>\n                </div>\n            </b-modal>\n            </b-skeleton-wrapper>\n        </b-card>\n        \n    </div>\n</template>\n\n\n<script>\nimport DeviceManagement from '@/components/DeviceManagement'\nimport ChangePasswordForm from '@/components/account/ChangePasswordForm.vue'\n\nexport default {\n    components: { \n        DeviceManagement,\n        ChangePasswordForm\n    },\n    created() {\n        // console.log(this.user)\n        this.generateAvtStr()\n        \n    },\n    data() {\n        return {\n            user: this.$session.get('user'),\n            avatarStr: '',\n            updateNameMode: false,\n            changePwMode: false,\n            deleteStatus: '',\n            user_db_host: this.$api_hosts['user_db_api'],\n            user_db_port: this.$api_ports['user_db_api'],\n            miband_db_host: this.$api_hosts['miband_db_api'],\n            miband_db_port: this.$api_ports['miband_db_api'],\n            miband_host: this.$api_hosts['miband_api'],\n            miband_port: this.$api_ports['miband_api']\n        }\n    },\n    methods: {\n        enterUpdateNameMode() {\n            this.updateNameMode = true\n        },\n        exitUpdateNameMode() {\n            this.user.fullname=this.$session.get('user').fullname\n            this.updateNameMode = false\n        },\n        enterChangePwMode() {\n            this.changePwMode = true\n        },\n        exitChangePwMode() {\n            this.changePwMode = false\n        },\n\n        generateAvtStr() {\n            if(this.user.fullname!=null) {\n                var str = String(this.$session.get('user').fullname)\n                var seperateName = str.split(\" \")\n                if(seperateName.length==1){\n                    this.avatarStr = seperateName[0][0]\n                } else {\n                    this.avatarStr=seperateName[0][0] + seperateName[seperateName.length-1][0]\n                }\n                \n            }\n            else{\n                this.avatarStr=''\n            }\n        },\n\n        async updateNameApiCall(newName) {\n            const uid = this.$session.get('user').id\n            try {\n                const response = await fetch(`http://${this.user_db_host}:${this.user_db_port}/users/${uid}/fullname`, {\n                method: 'PUT',\n                body: JSON.stringify({\n                    'fullname': newName,\n                    }),\n                headers: { 'Content-type': 'application/json; charset=UTF-8' },\n                })\n                const user = await response.json()\n                return user\n            } catch (error) {\n                console.error(error)\n            }\n        },\n        updateName() {\n            // this.updateNameApiCall(this.user.email, this.user.fullname)\n            this.updateNameApiCall(this.user.fullname).then((user)=>{\n                this.$session.set('user', user)\n                this.generateAvtStr()\n                this.exitUpdateNameMode()\n                // this.$forceUpdate\n            })\n        },\n\n        async deleteLogsApiCall() {\n            const user_id = this.$session.get('user').id\n            try {\n                const response = await fetch(`http://${this.miband_db_host}:${this.miband_db_port}/users/${user_id}/logs`, {\n                    method: 'DELETE'\n                })\n                const result = await response.json()\n                if(result['delete-result']=='succeeded') {\n                    return true\n                }\n                return false\n            }\n            catch (error) {\n                console.log(error)\n            }\n        },\n\n        async deleteUserApiCall() {\n            const user_id = this.$session.get('user').id\n            try {\n                const response = await fetch(`http://${this.user_db_host}:${this.user_db_port}/users/${user_id}`, {\n                    method: 'DELETE'\n                })\n                const result = await response.json()\n                if(result['delete-result']=='succeeded') {\n                    return true\n                }\n                return false\n            }\n            catch (error) {\n                console.log(error)\n            }\n        },\n\n        async unpairBandDbApiCall() {\n            const bandid = this.$session.get('miband').id\n            try {\n                const response = await fetch(`http://${this.miband_db_host}:${this.miband_db_port}/bands/${bandid}/unpair`)\n                const result = await response.json()\n\n                // do something with `data`\n                if(result['unpair-band-result']==\"succeeded\")\n                    return true\n                else return false\n            } catch (error) {\n                // do something with `error`\n            }\n        },\n\n        async disconnectApiCall() {\n            try {\n                const response = await fetch(`http://${this.miband_host}:${this.miband_port}/band/disconnect`)\n                const result = await response.json()\n                console.log(result)\n                return result\n            } catch (error) {\n                // do something with `error`\n            }\n        },\n\n        async deleteAndCloseModal() {\n            this.$bvModal.hide('confirm-remove-modal')\n\n            this.deleteStatus = 'PENDING'\n            \n            const deleteLogsResult = await this.deleteLogsApiCall()\n            var unpairBandResult = true\n            var deleteUserResult\n            if(deleteLogsResult) { //if succeeded\n                console.log(this.$session.get('miband'))\n                if(this.$session.get('miband')!=undefined) { //if pairing band exist\n                    console.log('??')\n                    await this.disconnectApiCall()\n                    unpairBandResult = await this.unpairBandDbApiCall()\n                }\n            }\n            if(unpairBandResult) {\n                deleteUserResult = await this.deleteUserApiCall()\n                if(deleteUserResult) {\n                    this.deleteStatus = 'OK'\n                    this.$session.destroy()\n                    this.$emit('login-status-change')\n                    this.$router.push('/')\n                }\n            }\n        },\n    }\n}\n</script>"]}]}