{"remainingRequest":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/account/SignInForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/account/SignInForm.vue","mtime":1607537916792},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9ybTogewogICAgICAgIGVtYWlsOiAnJywKICAgICAgICBwYXNzd29yZDogJycsCiAgICAgICAgY2hlY2tlZDogW10KICAgICAgfSwKICAgICAgc2hvdzogdHJ1ZSwKICAgICAgdmFsaWRTaWduaW46IG51bGwsCiAgICAgIHN1Ym1pdFN0YXR1czogbnVsbCwKICAgICAgdXNlcl9kYl9ob3N0OiB0aGlzLiRhcGlfaG9zdHNbJ3VzZXJfZGJfYXBpJ10sCiAgICAgIHVzZXJfZGJfcG9ydDogdGhpcy4kYXBpX3BvcnRzWyd1c2VyX2RiX2FwaSddCiAgICAgIC8vIGdldCB1c2VyX2RiX2hvc3QoKSB7CiAgICAgIC8vICAgcmV0dXJuIHRoaXMuJGFwaV9ob3N0c1sndXNlcl9kYl9hcGknXQogICAgICAvLyB9LAogICAgICAvLyBnZXQgdXNlcl9kYl9wb3J0KCkgewogICAgICAvLyAgIHJldHVybiB0aGlzLiRhcGlfcG9ydHNbJ3VzZXJfZGJfYXBpJ10KICAgICAgLy8gfSwKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHNpZ25pbihlbWFpbCwgcGFzc3dvcmQpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwOi8vJHt0aGlzLnVzZXJfZGJfaG9zdH06JHt0aGlzLnVzZXJfZGJfcG9ydH0vdXNlcnMvbG9naW5gLCB7CiAgICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgJ2VtYWlsJzogZW1haWwsCiAgICAgICAgICAgICdwYXNzd29yZCc6IHBhc3N3b3JkCiAgICAgICAgICAgIH0pLAogICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLTgnIH0sCiAgICAgICAgfSkKICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCkKICAgICAgICBpZiAocmVzdWx0Wydsb2dpbi1yZXN1bHQnXT09J3N1Y2NlZWRlZCcpIHsgLy9zaWduIGluIHN1Y2Nlc3NmdWxseQogICAgICAgICAgcmV0dXJuIHJlc3VsdFsndXNlciddCiAgICAgICAgfQogICAgICAgIC8vIGlmIHNpZ25pbiBmYWlsZWQKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKQogICAgICB9CiAgICB9LAoKICAgIG9uU3VibWl0KGV2dCkgewogICAgICBldnQucHJldmVudERlZmF1bHQoKQogICAgICAvL3NpZ24gaW4gYXBpCiAgICAgIHRoaXMuc2lnbmluKHRoaXMuZm9ybS5lbWFpbCwgdGhpcy5mb3JtLnBhc3N3b3JkKS50aGVuKChyZXN1bHQpPT57CiAgICAgICAgICBpZihyZXN1bHQpIHsgLy9pZiBzaWduIGluIHN1Y2NlZWRlZAogICAgICAgICAgICB0aGlzLnN1Ym1pdFN0YXR1cyA9ICdPSycKICAgICAgICAgICAgLy9zdGFydCBzZXNzaW9uCiAgICAgICAgICAgIHRoaXMuJHNlc3Npb24uc3RhcnQoKQogICAgICAgICAgICB0aGlzLiRzZXNzaW9uLnNldCgndXNlcicsIHJlc3VsdCkKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vcm91dGluZyB0byBob21lcGFnZQogICAgICAgICAgICB0aGlzLiRlbWl0KCJsb2dpbi1zdGF0dXMtY2hhbmdlIikKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy8nKQogICAgICAgICAgfSBlbHNlIHsgLy9pZiBzaWduIGluIGZhaWxlZAogICAgICAgICAgICB0aGlzLnN1Ym1pdFN0YXR1cyA9ICdFUlJPUicKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIHRoaXMuc3VibWl0U3RhdHVzID0gJ1BFTkRJTkcnCiAgICB9LAogICAgCiAgICBvblJlc2V0KGV2dCkgewogICAgICBldnQucHJldmVudERlZmF1bHQoKQogICAgICAvLyBSZXNldCBvdXIgZm9ybSB2YWx1ZXMKICAgICAgdGhpcy5mb3JtLmVtYWlsID0gJycKICAgICAgdGhpcy5mb3JtLnBhc3N3b3JkID0gJycKICAgICAgdGhpcy5mb3JtLmNoZWNrZWQgPSBbXQogICAgICAvLyBUcmljayB0byByZXNldC9jbGVhciBuYXRpdmUgYnJvd3NlciBmb3JtIHZhbGlkYXRpb24gc3RhdGUKICAgICAgdGhpcy5zaG93ID0gZmFsc2UKICAgICAgdGhpcy5zdWJtaXRTdGF0dXMgPSBudWxsCiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICB0aGlzLnNob3cgPSB0cnVlCiAgICAgIH0pCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["SignInForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SignInForm.vue","sourceRoot":"src/components/account","sourcesContent":["<template>\n  <div v-if=\"!this.$session.exists()\">\n    <b-card class=\"w-50 mx-auto mt-3\">\n      <div class=\"d-flex justify-content-center mb-3\" >\n        <b-button variant=\"outline-primary\">Sign In Form</b-button>\n      </div>\n      <div v-if=\"submitStatus === 'OK'\">\n        <b-alert variant=\"success\" show>Signed in successfully</b-alert>\n      </div>\n      <div v-if=\"submitStatus === 'ERROR'\">\n        <b-alert variant=\"danger\" show>Email and password are incorrect. Please check again</b-alert>\n      </div>\n      <div v-if=\"submitStatus === 'PENDING'\">\n        <b-alert variant=\"info\" show>Sending request...</b-alert>\n      </div>\n    \n      <b-form @submit=\"onSubmit\" @reset=\"onReset\" v-if=\"show\">\n      <b-form-group \n        label=\"Email address:\"\n      >\n          <b-form-input\n            v-model=\"form.email\"\n            type=\"email\"\n            required\n            placeholder=\"Enter email\"\n          ></b-form-input>\n      </b-form-group>\n\n      <b-form-group \n        label=\"Password:\"\n      >\n          <b-form-input\n            v-model=\"form.password\"\n            type=\"password\"\n            required\n            placeholder=\"Enter password\"\n          ></b-form-input>\n      </b-form-group>\n\n      <!-- <b-form-group>\n          <b-form-checkbox-group v-model=\"form.checked\">\n          <b-form-checkbox value=\"remember\">Remember me</b-form-checkbox>\n          </b-form-checkbox-group>\n      </b-form-group> -->\n\n      <div class=\"d-flex justify-content-center\">\n        <b-button type=\"signin\" variant=\"primary\">SignIn</b-button>\n        <b-button type=\"reset\" variant=\"danger\">Reset</b-button>\n      </div>\n      </b-form>\n    </b-card>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      form: {\n        email: '',\n        password: '',\n        checked: []\n      },\n      show: true,\n      validSignin: null,\n      submitStatus: null,\n      user_db_host: this.$api_hosts['user_db_api'],\n      user_db_port: this.$api_ports['user_db_api']\n      // get user_db_host() {\n      //   return this.$api_hosts['user_db_api']\n      // },\n      // get user_db_port() {\n      //   return this.$api_ports['user_db_api']\n      // },\n    }\n  },\n  methods: {\n    async signin(email, password) {\n      try {\n        const response = await fetch(`http://${this.user_db_host}:${this.user_db_port}/users/login`, {\n          method: 'POST',\n          body: JSON.stringify({\n            'email': email,\n            'password': password\n            }),\n          headers: { 'Content-type': 'application/json; charset=UTF-8' },\n        })\n        const result = await response.json()\n        if (result['login-result']=='succeeded') { //sign in successfully\n          return result['user']\n        }\n        // if signin failed\n        return false\n      } catch (error) {\n        console.error(error)\n      }\n    },\n\n    onSubmit(evt) {\n      evt.preventDefault()\n      //sign in api\n      this.signin(this.form.email, this.form.password).then((result)=>{\n          if(result) { //if sign in succeeded\n            this.submitStatus = 'OK'\n            //start session\n            this.$session.start()\n            this.$session.set('user', result)\n            \n            //routing to homepage\n            this.$emit(\"login-status-change\")\n            this.$router.push('/')\n          } else { //if sign in failed\n            this.submitStatus = 'ERROR'\n          }\n        })\n        this.submitStatus = 'PENDING'\n    },\n    \n    onReset(evt) {\n      evt.preventDefault()\n      // Reset our form values\n      this.form.email = ''\n      this.form.password = ''\n      this.form.checked = []\n      // Trick to reset/clear native browser form validation state\n      this.show = false\n      this.submitStatus = null\n      this.$nextTick(() => {\n        this.show = true\n      })\n    }\n  }\n}\n</script>\n"]}]}