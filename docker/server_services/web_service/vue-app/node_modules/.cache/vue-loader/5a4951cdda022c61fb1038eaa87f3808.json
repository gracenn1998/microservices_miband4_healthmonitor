{"remainingRequest":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/account/SignUpForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/account/SignUpForm.vue","mtime":1607335844903},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wdXRlZDogewogICAgZW1haWxTdGF0ZSgpIHsKICAgICAgcmV0dXJuIHRoaXMudmFsaWRFbWFpbAogICAgfSwKICAgIHB3U3RhdGUoKSB7CiAgICAgIGlmKHRoaXMuZm9ybS5wYXNzd29yZD09JycpIHsKICAgICAgICByZXR1cm4gbnVsbAogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmZvcm0ucGFzc3dvcmQubGVuZ3RoID49IDYKICAgIH0sCiAgICBjZlB3U3RhdGUoKSB7CiAgICAgIGlmKHRoaXMuZm9ybS5jZnBhc3N3b3JkPT0nJykgewogICAgICAgIHJldHVybiBudWxsCiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuZm9ybS5jZnBhc3N3b3JkID09IHRoaXMuZm9ybS5wYXNzd29yZAogICAgfSwKICAgIGludmFsaWRFbWFpbCgpIHsKICAgICAgaWYodGhpcy52YWxpZEVtYWlsPT1mYWxzZSkKICAgICAgICByZXR1cm4gJ1RoaXMgZW1haWwgaGFzIGJlZW4gdXNlZC4gUGxlYXNlIHRyeSBhbm90aGVyIGVtYWlsJwogICAgICByZXR1cm4gbnVsbAogICAgfSwKICAgIGludmFsaWRQdygpIHsKICAgICAgaWYgKHRoaXMuZm9ybS5wYXNzd29yZC5sZW5ndGggPiAwKSB7CiAgICAgICAgcmV0dXJuICdFbnRlciBhdCBsZWFzdCA2IGNoYXJhY3RlcnMuJwogICAgICB9CiAgICAgIHJldHVybiBudWxsCiAgICB9LAogICAgaW52YWxpZENmUHcoKSB7CiAgICAgIGlmICh0aGlzLmZvcm0uY2ZwYXNzd29yZC5sZW5ndGggPiAwKSB7CiAgICAgICAgcmV0dXJuICdDb25maXJtIHBhc3N3b3JkIG5lZWQgdG8gYmUgc2FtZSBhcyBwYXNzd29yZCcKICAgICAgfQogICAgICByZXR1cm4gbnVsbAogICAgfSwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBmb3JtOiB7CiAgICAgICAgZW1haWw6ICcnLAogICAgICAgIHBhc3N3b3JkOiAnJywKICAgICAgICBjZnBhc3N3b3JkOiAnJywKICAgICAgfSwKICAgICAgc2hvdzogdHJ1ZSwKICAgICAgdmFsaWRFbWFpbDogbnVsbCwKICAgICAgc3VibWl0U3RhdHVzOiBudWxsLAogICAgICB1c2VyX2RiX2hvc3Q6IHRoaXMuJGFwaV9ob3N0c1sndXNlcl9kYl9hcGknXSwKICAgICAgdXNlcl9kYl9wb3J0OiB0aGlzLiRhcGlfcG9ydHNbJ3VzZXJfZGJfYXBpJ10KICAgICAgLy8gZ2V0IHVzZXJfZGJfaG9zdCgpIHsKICAgICAgLy8gICByZXR1cm4gdGhpcy4kYXBpX2hvc3RzWyd1c2VyX2RiX2FwaSddCiAgICAgIC8vIH0sCiAgICAgIC8vIGdldCB1c2VyX2RiX3BvcnQoKSB7CiAgICAgIC8vICAgcmV0dXJuIHRoaXMuJGFwaV9wb3J0c1sndXNlcl9kYl9hcGknXQogICAgICAvLyB9LAogICAgfQogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHZhbGlkYXRlRW1haWwoZW1haWwpIHsKICAgICAgY29uc3QgcGFyYW1zID0gJ2VtYWlsPScrZW1haWwKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwOi8vJHt0aGlzLnVzZXJfZGJfaG9zdH06JHt0aGlzLnVzZXJfZGJfcG9ydH0vdXNlcnMvZmluZC1ieS1lbWFpbD8ke3BhcmFtc31gKQogICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKQogICAgICAgIGlmIChyZXN1bHQudXNlciE9bnVsbCkgewogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcikKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGFkZFVzZXIodXNlcikgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHA6Ly8ke3RoaXMudXNlcl9kYl9ob3N0fToke3RoaXMudXNlcl9kYl9wb3J0fS91c2Vyc2AsIHsKICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodXNlciksCiAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD1VVEYtOCcgfSwKICAgICAgICB9KQogICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZQogICAgICAgIGNvbnNvbGUubG9nKGRhdGEpCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcikKICAgICAgfQogICAgfSwKICAgIG9uU3VibWl0KGV2dCkgewogICAgICBldnQucHJldmVudERlZmF1bHQoKQogICAgICAvL2NoZWNrIGlmIGVudGVyZWQgcHcgYW5kIGNmcHcgYXJlIHZhbGlkIG9yIG5vdAogICAgICBpZih0aGlzLnB3U3RhdGUgJiYgdGhpcy5jZlB3U3RhdGUpIHsgLy9pZiBib3RoIGFyZSB2YWxpZAogICAgICAgIHRoaXMudmFsaWRhdGVFbWFpbCh0aGlzLmZvcm0uZW1haWwpLnRoZW4oKGFibGVUb0FkZCk9PnsgCiAgICAgICAgICAvL2NoZWNrIGlmIGVtYWlsIGlzIHZhbGlkIG9yIG5vdAogICAgICAgICAgaWYoYWJsZVRvQWRkKSB7IC8vaWYgZW1haWwgaGFzbnQgYmVlbiB1c2VkCiAgICAgICAgICAgIHRoaXMuYWRkVXNlcih0aGlzLmZvcm0pLnRoZW4oKCk9PnsKICAgICAgICAgICAgICB0aGlzLnZhbGlkRW1haWwgPSB0cnVlCiAgICAgICAgICAgICAgdGhpcy5zdWJtaXRTdGF0dXMgPSAnT0snCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHRoaXMuc3VibWl0U3RhdHVzID0gJ1BFTkRJTkcnCiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIHsgLy9pZiBlbWFpbCBleGlzdHMgaW4gZHRiCiAgICAgICAgICAgIHRoaXMudmFsaWRFbWFpbCA9IGZhbHNlCiAgICAgICAgICAgIHRoaXMuc3VibWl0U3RhdHVzID0gJ0VSUk9SJwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zdWJtaXRTdGF0dXMgPSAnRVJST1InCiAgICAgIH0KICAgIH0sCiAgICAKICAgIG9uUmVzZXQoZXZ0KSB7CiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpCiAgICAgIC8vIFJlc2V0IG91ciBmb3JtIHZhbHVlcwogICAgICB0aGlzLmZvcm0uZW1haWwgPSAnJwogICAgICB0aGlzLmZvcm0ucGFzc3dvcmQgPSAnJwogICAgICB0aGlzLmZvcm0uY2ZwYXNzd29yZCA9ICcnCiAgICAgIC8vIFRyaWNrIHRvIHJlc2V0L2NsZWFyIG5hdGl2ZSBicm93c2VyIGZvcm0gdmFsaWRhdGlvbiBzdGF0ZQogICAgICB0aGlzLnNob3cgPSBmYWxzZQogICAgICB0aGlzLnN1Ym1pdFN0YXR1cyA9IG51bGwKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMuc2hvdyA9IHRydWUKICAgICAgfSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["SignUpForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SignUpForm.vue","sourceRoot":"src/components/account","sourcesContent":["<template>\n  <div>\n    <b-card class=\"w-50 mx-auto mt-3\">\n      <div class=\"d-flex justify-content-center mb-3\">\n        <b-button variant=\"outline-primary\">Sign Up Form</b-button>\n      </div>\n      <div v-if=\"submitStatus === 'OK'\">\n        <b-alert variant=\"success\" show>Signed up successfully. Sign in now?</b-alert>\n      </div>\n      <div v-if=\"submitStatus === 'ERROR'\">\n        <b-alert variant=\"danger\" show>Please check all the fields again.</b-alert>\n      </div>\n      <div v-if=\"submitStatus === 'PENDING'\">\n        <b-alert variant=\"info\" show>Sending request...</b-alert>\n      </div>\n\n      <b-form @submit=\"onSubmit\" @reset=\"onReset\" v-if=\"show\">\n      <b-form-group \n        label=\"Email address:\"\n        :invalid-feedback=\"invalidEmail\"\n        :state=\"emailState\"\n      >\n          <b-form-input\n            v-model=\"form.email\"\n            type=\"email\"\n            required\n            placeholder=\"Enter email\"\n          ></b-form-input>\n      </b-form-group>\n\n      <b-form-group \n        label=\"Password:\"\n        :invalid-feedback=\"invalidPw\"\n        :state=\"pwState\"\n      >\n          <b-form-input\n            v-model=\"form.password\"\n            :state=\"pwState\"\n            type=\"password\"\n            required\n            placeholder=\"Enter password\"\n          ></b-form-input>\n      </b-form-group>\n\n      <b-form-group \n        label=\"Confirm Password:\"\n        :invalid-feedback=\"invalidCfPw\"\n        :state=\"cfPwState\"  \n      >\n          <b-form-input\n            v-model=\"form.cfpassword\"\n            :state=\"cfPwState\"\n            type=\"password\"\n            required\n            placeholder=\"Re-enter password\"\n          ></b-form-input>\n      </b-form-group>\n\n      <div class=\"d-flex justify-content-center\">\n        <b-button type=\"submit\" variant=\"primary\">SignUp</b-button>\n        <b-button type=\"reset\" variant=\"danger\">Reset</b-button>\n      </div>\n      </b-form>\n    </b-card>\n  </div>\n</template>\n\n<script>\nexport default {\n  computed: {\n    emailState() {\n      return this.validEmail\n    },\n    pwState() {\n      if(this.form.password=='') {\n        return null\n      }\n      return this.form.password.length >= 6\n    },\n    cfPwState() {\n      if(this.form.cfpassword=='') {\n        return null\n      }\n      return this.form.cfpassword == this.form.password\n    },\n    invalidEmail() {\n      if(this.validEmail==false)\n        return 'This email has been used. Please try another email'\n      return null\n    },\n    invalidPw() {\n      if (this.form.password.length > 0) {\n        return 'Enter at least 6 characters.'\n      }\n      return null\n    },\n    invalidCfPw() {\n      if (this.form.cfpassword.length > 0) {\n        return 'Confirm password need to be same as password'\n      }\n      return null\n    },\n  },\n  data() {\n    return {\n      form: {\n        email: '',\n        password: '',\n        cfpassword: '',\n      },\n      show: true,\n      validEmail: null,\n      submitStatus: null,\n      user_db_host: this.$api_hosts['user_db_api'],\n      user_db_port: this.$api_ports['user_db_api']\n      // get user_db_host() {\n      //   return this.$api_hosts['user_db_api']\n      // },\n      // get user_db_port() {\n      //   return this.$api_ports['user_db_api']\n      // },\n    }\n  },\n\n  methods: {\n    async validateEmail(email) {\n      const params = 'email='+email\n      try {\n        const response = await fetch(`http://${this.user_db_host}:${this.user_db_port}/users/find-by-email?${params}`)\n        const result = await response.json()\n        if (result.user!=null) {\n          return false\n        }\n        return true\n      } catch (error) {\n        console.error(error)\n      }\n    },\n    async addUser(user) {\n      try {\n        const response = await fetch(`http://${this.user_db_host}:${this.user_db_port}/users`, {\n          method: 'POST',\n          body: JSON.stringify(user),\n          headers: { 'Content-type': 'application/json; charset=UTF-8' },\n        })\n        const data = await response\n        console.log(data)\n      } catch (error) {\n        console.error(error)\n      }\n    },\n    onSubmit(evt) {\n      evt.preventDefault()\n      //check if entered pw and cfpw are valid or not\n      if(this.pwState && this.cfPwState) { //if both are valid\n        this.validateEmail(this.form.email).then((ableToAdd)=>{ \n          //check if email is valid or not\n          if(ableToAdd) { //if email hasnt been used\n            this.addUser(this.form).then(()=>{\n              this.validEmail = true\n              this.submitStatus = 'OK'\n            })\n            this.submitStatus = 'PENDING'\n          }\n          else { //if email exists in dtb\n            this.validEmail = false\n            this.submitStatus = 'ERROR'\n          }\n        })\n      } else {\n        this.submitStatus = 'ERROR'\n      }\n    },\n    \n    onReset(evt) {\n      evt.preventDefault()\n      // Reset our form values\n      this.form.email = ''\n      this.form.password = ''\n      this.form.cfpassword = ''\n      // Trick to reset/clear native browser form validation state\n      this.show = false\n      this.submitStatus = null\n      this.$nextTick(() => {\n        this.show = true\n      })\n    }\n  }\n}\n</script>\n"]}]}