{"remainingRequest":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/babel-loader/lib/index.js!/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/DeviceManagement.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/DeviceManagement.vue","mtime":1607284537696},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL2dyYWNlL3BqL21pY3Jvc2VydmljZXNfbWliYW5kNF9oZWFsdGhtb25pdG9yL2Zyb250ZW5kL3Z1ZS1hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgUGFpckRldmljZUZvcm0gZnJvbSAnQC9jb21wb25lbnRzL2RldmljZS9QYWlyRGV2aWNlRm9ybSc7CmltcG9ydCBEZXZpY2VMaXN0IGZyb20gJ0AvY29tcG9uZW50cy9kZXZpY2UvRGV2aWNlTGlzdCc7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBQYWlyRGV2aWNlRm9ybTogUGFpckRldmljZUZvcm0sCiAgICBEZXZpY2VMaXN0OiBEZXZpY2VMaXN0CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYWRkQmFuZE1vZGU6IGZhbHNlLAogICAgICBsaXN0a2V5OiBmYWxzZSwKICAgICAgbWliYW5kX2RiX2hvc3Q6IHRoaXMuJGFwaV9ob3N0c1snbWliYW5kX2RiX2FwaSddLAogICAgICBtaWJhbmRfZGJfcG9ydDogdGhpcy4kYXBpX3BvcnRzWydtaWJhbmRfZGJfYXBpJ10sCiAgICAgIG1pYmFuZF9ob3N0OiB0aGlzLiRhcGlfaG9zdHNbJ21pYmFuZF9hcGknXSwKICAgICAgbWliYW5kX3BvcnQ6IHRoaXMuJGFwaV9wb3J0c1snbWliYW5kX2FwaSddCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgZW50ZXJBZGRCYW5kTW9kZTogZnVuY3Rpb24gZW50ZXJBZGRCYW5kTW9kZSgpIHsKICAgICAgdGhpcy5hZGRCYW5kTW9kZSA9IHRydWU7CiAgICB9LAogICAgZXhpdEFkZEJhbmRNb2RlOiBmdW5jdGlvbiBleGl0QWRkQmFuZE1vZGUoKSB7CiAgICAgIHRoaXMuYWRkQmFuZE1vZGUgPSBmYWxzZTsKICAgIH0sCiAgICB1cGRhdGVMaXN0RGlzcGxheTogZnVuY3Rpb24gdXBkYXRlTGlzdERpc3BsYXkoKSB7CiAgICAgIHRoaXMubGlzdGtleSA9ICF0aGlzLmxpc3RrZXk7CiAgICB9LAogICAgcmVtb3ZlQmFuZERiQXBpQ2FsbDogZnVuY3Rpb24gcmVtb3ZlQmFuZERiQXBpQ2FsbChiYW5kKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBiYW5kaWQsIHJlc3BvbnNlLCByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYmFuZGlkID0gX3RoaXMuJHNlc3Npb24uZ2V0KCdtaWJhbmQnKS5pZDsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gZmV0Y2goImh0dHA6Ly8iLmNvbmNhdChfdGhpcy5taWJhbmRfZGJfaG9zdCwgIjoiKS5jb25jYXQoX3RoaXMubWliYW5kX2RiX3BvcnQsICIvYmFuZHMvIikuY29uY2F0KGlkKSwgewogICAgICAgICAgICAgICAgICBtZXRob2Q6ICJERUxFVEUiCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmICghKHJlc3VsdFsnZGVsZXRlLXJlc3VsdCddID09ICJzdWNjZWVkZWQiKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHRydWUpOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTU7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDEpOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1sxLCAxNV1dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZGlzY29ubmVjdEFwaUNhbGw6IGZ1bmN0aW9uIGRpc2Nvbm5lY3RBcGlDYWxsKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciByZXNwb25zZSwgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDA7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gZmV0Y2goImh0dHA6Ly8iLmNvbmNhdChfdGhpczIubWliYW5kX2hvc3QsICI6IikuY29uY2F0KF90aGlzMi5taWJhbmRfcG9ydCwgIi9iYW5kL2Rpc2Nvbm5lY3QiKSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDY7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgcmVzdWx0KTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMTE7CiAgICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oMCk7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIG51bGwsIFtbMCwgMTFdXSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHJlbW92ZUJhbmQ6IGZ1bmN0aW9uIHJlbW92ZUJhbmQoYmFuZCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMuZGlzY29ubmVjdEFwaUNhbGwoKTsKICAgICAgdGhpcy5yZW1vdmVCYW5kRGJBcGlDYWxsKGJhbmQpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMy4kc2Vzc2lvbi5yZW1vdmUoJ21pYmFuZCcpOwoKICAgICAgICBfdGhpczMudXBkYXRlTGlzdERpc3BsYXkoKTsKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["DeviceManagement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAeA,OAAA,cAAA,MAAA,oCAAA;AACA,OAAA,UAAA,MAAA,gCAAA;AAEA,eAAA;AACA,EAAA,UAAA,EAAA;AACA,IAAA,cAAA,EAAA,cADA;AAEA,IAAA,UAAA,EAAA;AAFA,GADA;AAKA,EAAA,IALA,kBAKA;AACA,WAAA;AACA,MAAA,WAAA,EAAA,KADA;AAEA,MAAA,OAAA,EAAA,KAFA;AAGA,MAAA,cAAA,EAAA,KAAA,UAAA,CAAA,eAAA,CAHA;AAIA,MAAA,cAAA,EAAA,KAAA,UAAA,CAAA,eAAA,CAJA;AAKA,MAAA,WAAA,EAAA,KAAA,UAAA,CAAA,YAAA,CALA;AAMA,MAAA,WAAA,EAAA,KAAA,UAAA,CAAA,YAAA;AANA,KAAA;AAQA,GAdA;AAeA,EAAA,OAAA,EAAA;AACA,IAAA,gBADA,8BACA;AACA,WAAA,WAAA,GAAA,IAAA;AACA,KAHA;AAIA,IAAA,eAJA,6BAIA;AACA,WAAA,WAAA,GAAA,KAAA;AACA,KANA;AAQA,IAAA,iBARA,+BAQA;AACA,WAAA,OAAA,GAAA,CAAA,KAAA,OAAA;AACA,KAVA;AAYA,IAAA,mBAZA,+BAYA,IAZA,EAYA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAA,MADA,GACA,KAAA,CAAA,QAAA,CAAA,GAAA,CAAA,QAAA,EAAA,EADA;AAAA;AAAA;AAAA,uBAGA,KAAA,kBAAA,KAAA,CAAA,cAAA,cAAA,KAAA,CAAA,cAAA,oBAAA,EAAA,GAAA;AACA,kBAAA,MAAA,EAAA;AADA,iBAAA,CAHA;;AAAA;AAGA,gBAAA,QAHA;AAAA;AAAA,uBAMA,QAAA,CAAA,IAAA,EANA;;AAAA;AAMA,gBAAA,MANA;;AAAA,sBASA,MAAA,CAAA,eAAA,CAAA,IAAA,WATA;AAAA;AAAA;AAAA;;AAAA,iDAUA,IAVA;;AAAA;AAAA,iDAWA,KAXA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAeA,KA3BA;AA6BA,IAAA,iBA7BA,+BA6BA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEA,KAAA,kBAAA,MAAA,CAAA,WAAA,cAAA,MAAA,CAAA,WAAA,sBAFA;;AAAA;AAEA,gBAAA,QAFA;AAAA;AAAA,uBAGA,QAAA,CAAA,IAAA,EAHA;;AAAA;AAGA,gBAAA,MAHA;AAIA,gBAAA,OAAA,CAAA,GAAA,CAAA,MAAA;AAJA,kDAKA,MALA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA,KAtCA;AAwCA,IAAA,UAxCA,sBAwCA,IAxCA,EAwCA;AAAA;;AACA,WAAA,iBAAA;AACA,WAAA,mBAAA,CAAA,IAAA,EAAA,IAAA,CAAA,YAAA;AACA,QAAA,MAAA,CAAA,QAAA,CAAA,MAAA,CAAA,QAAA;;AACA,QAAA,MAAA,CAAA,iBAAA;AACA,OAHA;AAIA;AA9CA;AAfA,CAAA","sourcesContent":["<template>\n    <b-card title=\"My device\">\n        <b-button variant=\"outline-primary\" class=\"w-100\" @click=\"enterAddBandMode\">+ Add device</b-button>\n        <pair-device-form v-if=\"addBandMode\" \n            @exit-add-band-mode=\"exitAddBandMode\"\n            @update-list-display=\"updateListDisplay\"\n        />\n        <device-list class=\"mt-1\" :key=\"listkey\"\n            @unpair-band=\"removeBand\"\n            @update-list-display=\"updateListDisplay\"\n        />\n    </b-card>\n</template>\n\n<script>\nimport PairDeviceForm from '@/components/device/PairDeviceForm'\nimport DeviceList from '@/components/device/DeviceList'\n\nexport default {\n    components: { \n        PairDeviceForm,\n        DeviceList\n    },\n    data() {\n        return {\n            addBandMode: false,\n            listkey: false,\n            miband_db_host: this.$api_hosts['miband_db_api'],\n            miband_db_port: this.$api_ports['miband_db_api'],\n            miband_host: this.$api_hosts['miband_api'],\n            miband_port: this.$api_ports['miband_api']\n        }\n    },\n    methods: {\n        enterAddBandMode() {\n            this.addBandMode = true\n        },\n        exitAddBandMode() {\n            this.addBandMode = false\n        },\n\n        updateListDisplay() {\n            this.listkey = !this.listkey\n        },\n\n        async removeBandDbApiCall(band) {\n            const bandid = this.$session.get('miband').id\n            try {\n                const response = await fetch(`http://${this.miband_db_host}:${this.miband_db_port}/bands/${id}`, {\n                    method: \"DELETE\"\n                })\n                const result = await response.json()\n\n                // do something with `data`\n                if(result['delete-result']==\"succeeded\")\n                    return true\n                else return false\n            } catch (error) {\n                // do something with `error`\n            }\n        },\n\n        async disconnectApiCall() {\n            try {\n                const response = await fetch(`http://${this.miband_host}:${this.miband_port}/band/disconnect`)\n                const result = await response.json()\n                console.log(result)\n                return result\n            } catch (error) {\n                // do something with `error`\n            }\n        },\n\n        removeBand(band) {\n            this.disconnectApiCall()\n            this.removeBandDbApiCall(band).then(()=>{\n                this.$session.remove('miband')\n                this.updateListDisplay()\n            })\n        }\n    }\n}\n</script>"],"sourceRoot":"src/components"}]}