{"remainingRequest":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/babel-loader/lib/index.js!/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/Data.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/src/components/Data.vue","mtime":1608331295782},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/grace/pj/microservices_miband4_healthmonitor/frontend/vue-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL2dyYWNlL3BqL21pY3Jvc2VydmljZXNfbWliYW5kNF9oZWFsdGhtb25pdG9yL2Zyb250ZW5kL3Z1ZS1hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgKiBhcyBtaWJhbmRfY29ubiBmcm9tICdAL2FwaV9jYWxscy9NaWJhbmRDb25uZWN0aW9uLmpzJzsKaW1wb3J0ICogYXMgbWliYW5kX2RiIGZyb20gJ0AvYXBpX2NhbGxzL01pYmFuZERiLmpzJzsKaW1wb3J0IEdlbmVyYWxEYXRhIGZyb20gJ0AvY29tcG9uZW50cy9kYXRhL0dlbmVyYWxEYXRhJzsKaW1wb3J0IERhdGFUeXBlIGZyb20gJ0AvY29tcG9uZW50cy9kYXRhL0RhdGFUeXBlJzsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIEdlbmVyYWxEYXRhOiBHZW5lcmFsRGF0YSwKICAgIERhdGFUeXBlOiBEYXRhVHlwZQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGhyX2tleTogZmFsc2UsCiAgICAgIGNvbm5lY3RTdGF0dXM6ICcnLAogICAgICBnZGtleTogZmFsc2UKICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAvL2dldCBkYXRhIGlmIG5vdCBzdG9yZWQgaW4gc2Vzc2lvbiB5ZXQKICAgIGlmICh0aGlzLiRzZXNzaW9uLmdldCgnbWliYW5kJykgPT0gdW5kZWZpbmVkKSB7CiAgICAgIHZhciB1c2VyaWQgPSB0aGlzLiRzZXNzaW9uLmdldCgndXNlcicpLmlkOwogICAgICBtaWJhbmRfZGIuZ2V0VXNlckJhbmRJbmZvKHVzZXJpZCkudGhlbihmdW5jdGlvbiAoYmFuZGluZm8pIHsKICAgICAgICBpZiAoYmFuZGluZm8pIHsKICAgICAgICAgIF90aGlzLiRzZXNzaW9uLnNldCgnbWliYW5kJywgYmFuZGluZm8pOwoKICAgICAgICAgIF90aGlzLiRlbWl0KCd1cGRhdGUtbGlzdC1kaXNwbGF5Jyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGdldEJhbmRJbmZvOiBmdW5jdGlvbiBnZXRCYW5kSW5mbygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciB1c2VyaWQsIHBhcmFtcywgcmVzcG9uc2UsIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB1c2VyaWQgPSBfdGhpczIuJHNlc3Npb24uZ2V0KCd1c2VyJykuaWQ7CiAgICAgICAgICAgICAgICBwYXJhbXMgPSAndXNlcl9pZD0nICsgdXNlcmlkOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiBmZXRjaCgiaHR0cDovLyIuY29uY2F0KF90aGlzMi5taWJhbmRfZGJfaG9zdCwgIjoiKS5jb25jYXQoX3RoaXMyLm1pYmFuZF9kYl9wb3J0LCAiL2JhbmRzL2ZpbmQtYnktdXNlcmlkPyIpLmNvbmNhdChwYXJhbXMpKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmICghKHJlc3VsdFsnZ2V0LWJhbmQtcmVzdWx0J10gPT0gJ3N1Y2NlZWRlZCcpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVzdWx0WydiYW5kLWluZm8nXSk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBmYWxzZSk7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTQ7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDIpOwoKICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1syLCAxNF1dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgcmVjb25uZWN0OiBmdW5jdGlvbiByZWNvbm5lY3QoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIG1pYmFuZCA9IHRoaXMuJHNlc3Npb24uZ2V0KCdtaWJhbmQnKTsKICAgICAgbWliYW5kX2Nvbm4uZGlzY29ubmVjdEFwaUNhbGwoKS50aGVuKG1pYmFuZF9jb25uLmNvbm5lY3RBcGlDYWxsKG1pYmFuZC5tYWNfYWRkcmVzcywgbWliYW5kLmF1dGhfa2V5KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgICBfdGhpczMuY29ubmVjdFN0YXR1cyA9ICdPSyc7CiAgICAgICAgICBfdGhpczMuZ2RrZXkgPSAhX3RoaXMzLmdka2V5OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpczMuY29ubmVjdFN0YXR1cyA9ICdFUlJPUic7CiAgICAgICAgfQogICAgICB9KSk7CiAgICAgIHRoaXMuY29ubmVjdFN0YXR1cyA9ICdQRU5ESU5HJzsKICAgIH0KICB9Cn07"},{"version":3,"sources":["Data.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA,OAAA,KAAA,WAAA,MAAA,iCAAA;AACA,OAAA,KAAA,SAAA,MAAA,yBAAA;AAEA,OAAA,WAAA,MAAA,+BAAA;AACA,OAAA,QAAA,MAAA,4BAAA;AAEA,eAAA;AACA,EAAA,UAAA,EAAA;AACA,IAAA,WAAA,EAAA,WADA;AAEA,IAAA,QAAA,EAAA;AAFA,GADA;AAKA,EAAA,IALA,kBAKA;AACA,WAAA;AACA,MAAA,MAAA,EAAA,KADA;AAEA,MAAA,aAAA,EAAA,EAFA;AAGA,MAAA,KAAA,EAAA;AAHA,KAAA;AAKA,GAXA;AAYA,EAAA,OAZA,qBAYA;AAAA;;AACA;AACA,QAAA,KAAA,QAAA,CAAA,GAAA,CAAA,QAAA,KAAA,SAAA,EAAA;AACA,UAAA,MAAA,GAAA,KAAA,QAAA,CAAA,GAAA,CAAA,MAAA,EAAA,EAAA;AAEA,MAAA,SAAA,CAAA,eAAA,CAAA,MAAA,EAAA,IAAA,CAAA,UAAA,QAAA,EAAA;AACA,YAAA,QAAA,EAAA;AACA,UAAA,KAAA,CAAA,QAAA,CAAA,GAAA,CAAA,QAAA,EAAA,QAAA;;AACA,UAAA,KAAA,CAAA,KAAA,CAAA,qBAAA;AACA;AACA,OALA;AAMA;AACA,GAxBA;AA0BA,EAAA,OAAA,EAAA;AACA,IAAA,WADA,yBACA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAA,MADA,GACA,MAAA,CAAA,QAAA,CAAA,GAAA,CAAA,MAAA,EAAA,EADA;AAEA,gBAAA,MAFA,GAEA,aAAA,MAFA;AAAA;AAAA;AAAA,uBAIA,KAAA,kBAAA,MAAA,CAAA,cAAA,cAAA,MAAA,CAAA,cAAA,mCAAA,MAAA,EAJA;;AAAA;AAIA,gBAAA,QAJA;AAAA;AAAA,uBAKA,QAAA,CAAA,IAAA,EALA;;AAAA;AAKA,gBAAA,MALA;;AAAA,sBAMA,MAAA,CAAA,iBAAA,CAAA,IAAA,WANA;AAAA;AAAA;AAAA;;AAAA,iDAOA,MAAA,CAAA,WAAA,CAPA;;AAAA;AAAA,iDASA,KATA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA,KAdA;AAiBA,IAAA,SAjBA,uBAiBA;AAAA;;AACA,UAAA,MAAA,GAAA,KAAA,QAAA,CAAA,GAAA,CAAA,QAAA,CAAA;AACA,MAAA,WAAA,CAAA,iBAAA,GAAA,IAAA,CACA,WAAA,CAAA,cAAA,CAAA,MAAA,CAAA,WAAA,EAAA,MAAA,CAAA,QAAA,EAAA,IAAA,CAAA,UAAA,MAAA,EAAA;AACA,YAAA,MAAA,EAAA;AACA,UAAA,MAAA,CAAA,aAAA,GAAA,IAAA;AACA,UAAA,MAAA,CAAA,KAAA,GAAA,CAAA,MAAA,CAAA,KAAA;AACA,SAHA,MAIA;AACA,UAAA,MAAA,CAAA,aAAA,GAAA,OAAA;AACA;AACA,OARA,CADA;AAWA,WAAA,aAAA,GAAA,SAAA;AACA;AA/BA;AA1BA,CAAA","sourcesContent":["<template>\n    <div class=\"w-50 mx-auto mt-3\">\n        <b-card no-body >\n          <b-button @click=\"reconnect\" variant=\"primary\">Reconnect</b-button>\n          <div v-if=\"connectStatus === 'ERROR'\">\n            <b-alert variant=\"danger\" show>Error happened while connecting. Please try again or refresh your Bluetooth connection</b-alert>\n          </div>\n          <div v-if=\"connectStatus === 'PENDING'\">\n            <b-alert variant=\"info\" show>Connecting...</b-alert>\n          </div>\n          <b-tabs card>\n            <b-tab title=\"General Information\" active lazy> \n              <GeneralData :key='gdkey'/>\n            </b-tab>\n            <b-tab title=\"Step Counts\" lazy>\n              <DataType :type=\"'steps'\" />\n            </b-tab>\n            <b-tab title=\"Heart Rate\" lazy>\n              <DataType :type=\"'hr'\" />\n            </b-tab>\n        </b-tabs>\n      </b-card>\n    </div>\n</template>\n\n<script>\nimport * as miband_conn from '@/api_calls/MibandConnection.js'\nimport * as miband_db from '@/api_calls/MibandDb.js'\n\nimport GeneralData from '@/components/data/GeneralData'\nimport DataType from '@/components/data/DataType'\n\nexport default {\n  components: {\n    GeneralData,\n    DataType\n  },\n  data() {\n    return {\n      hr_key: false,\n      connectStatus: '',\n      gdkey: false,\n    }\n  },\n  created() {\n    //get data if not stored in session yet\n    if(this.$session.get('miband')==undefined) {\n      const userid = this.$session.get('user').id\n\n      miband_db.getUserBandInfo(userid).then((bandinfo)=>{\n        if(bandinfo){\n          this.$session.set('miband', bandinfo)\n          this.$emit('update-list-display')\n        }\n      })\n    }\n  },\n\n  methods: {\n    async getBandInfo() {\n      const userid = this.$session.get('user').id\n      const params = 'user_id='+userid\n      try {\n          const response = await fetch(`http://${this.miband_db_host}:${this.miband_db_port}/bands/find-by-userid?${params}`)\n          const result = await response.json()\n          if(result['get-band-result']=='succeeded') {\n            return result['band-info']\n          }\n          return false\n      } catch (error) {\n          // do something with `error`\n      }\n    },\n\n\n    reconnect() {\n      var miband = this.$session.get('miband')\n      miband_conn.disconnectApiCall().then(\n        miband_conn.connectApiCall(miband.mac_address, miband.auth_key).then((result)=>{\n          if(result) {\n            this.connectStatus='OK'\n            this.gdkey = !this.gdkey\n          }\n          else {\n            this.connectStatus='ERROR'\n          }\n        })\n      )\n      this.connectStatus='PENDING'\n    }\n\n  }\n}\n</script>\n"],"sourceRoot":"src/components"}]}